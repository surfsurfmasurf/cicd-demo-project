<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Interactive Particle Animation - CI/CD Demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            overflow: hidden;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent; /* Î™®Î∞îÏùº ÌÑ∞Ïπò ÌïòÏù¥ÎùºÏù¥Ìä∏ Ï†úÍ±∞ */
        }
        body {
            background: #000;
            touch-action: none; /* Ïä§ÌÅ¨Î°§ Î∞©ÏßÄ */
        }
        
        /* ÏÉÅÎã® Î™®Îìú Ï†ïÎ≥¥ */
        #modeInfo {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-family: 'Pretendard', -apple-system, sans-serif;
            background: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            pointer-events: none; /* ÌÑ∞Ïπò ÌÜµÍ≥º */
            white-space: nowrap;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(4px);
        }

        /* ÌïòÎã® Ïª®Ìä∏Î°§ Ìå®ÎÑê (Î™®Î∞îÏùº ÏπúÌôîÏ†Å) */
        #mobile-controls {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 100;
            width: 90%;
            max-width: 500px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            backdrop-filter: blur(4px);
            transition: all 0.2s ease;
            flex: 1;
            min-width: 70px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn:active {
            transform: scale(0.95);
            background: rgba(56, 189, 248, 0.3);
            border-color: #38bdf8;
        }

        .btn-icon {
            font-size: 18px;
            margin-bottom: 4px;
            display: block;
        }

        /* Îç∞Ïä§ÌÅ¨ÌÉëÏö© ÎèÑÏõÄÎßê (ÏûëÍ≤å ÌëúÏãú) */
        #desktop-hint {
            position: absolute;
            top: 20px;
            right: 20px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            text-align: right;
            pointer-events: none;
        }
        @media (max-width: 768px) {
            #desktop-hint { display: none; }
        }
    </style>
</head>
<body>
    <div id="modeInfo">Floating Behavior</div>
    
    <!-- Î™®Î∞îÏùº Ïª®Ìä∏Î°§ Î≤ÑÌäº -->
    <div id="mobile-controls">
        <button class="btn" onclick="changeMode()">
            <span class="btn-icon">üîÑ</span>Mode
        </button>
        <button class="btn" onclick="changeColor()">
            <span class="btn-icon">üé®</span>Color
        </button>
        <button class="btn" onclick="toggleTrails()">
            <span class="btn-icon">‚ú®</span>Trail
        </button>
        <button class="btn" onclick="resetParticles()">
            <span class="btn-icon">üóëÔ∏è</span>Reset
        </button>
    </div>

    <div id="desktop-hint">
        Click/Touch: Explode<br>
        Drag: Attract
    </div>

    <script>
        let particles = [];
        let mode = 0; // 0: floating, 1: spiral, 2: fireworks, 3: wave
        let colorScheme = 0;
        let showTrails = false;
        const modes = ['Floating Behavior', 'Spiral Dance', 'Fireworks', 'Wave Pattern'];
        
        function updateModeInfo() {
            document.getElementById('modeInfo').textContent = modes[mode];
        }

        // --- Global Control Functions (Called by HTML Buttons) ---
        function changeMode() {
            mode = (mode + 1) % modes.length;
            updateModeInfo();
        }

        function changeColor() {
            colorScheme = (colorScheme + 1) % 4;
            particles.forEach(p => p.color = p.getColor());
        }

        function toggleTrails() {
            showTrails = !showTrails;
        }

        function resetParticles() {
            particles = [];
            for (let i = 0; i < 200; i++) {
                particles.push(new Particle());
            }
        }
        
        // --- p5.js Class ---
        class Particle {
            constructor(x, y, isExplosion = false) {
                this.pos = createVector(x || random(width), y || random(height));
                this.vel = isExplosion 
                    ? p5.Vector.random2D().mult(random(5, 15))
                    : createVector(random(-1, 1), random(-1, 1));
                this.acc = createVector(0, 0);
                this.size = random(3, 8);
                this.color = this.getColor();
                this.lifespan = isExplosion ? 100 : 255;
                this.isExplosion = isExplosion;
                this.angle = random(TWO_PI);
                this.angleVel = random(-0.1, 0.1);
            }
            
            getColor() {
                const schemes = [
                    [color(255, 0, 255), color(0, 255, 255), color(255, 255, 0), color(0, 255, 0)],
                    [color(255, 100, 100), color(100, 100, 255), color(100, 255, 100), color(255, 255, 100)],
                    [color(255, 0, 128), color(128, 0, 255), color(0, 128, 255), color(255, 128, 0)],
                    [color(255, 200, 0), color(255, 0, 200), color(0, 255, 200), color(200, 255, 0)]
                ];
                return random(schemes[colorScheme]);
            }
            
            applyForce(force) {
                this.acc.add(force);
            }
            
            update() {
                // Mode-specific behaviors
                switch(mode) {
                    case 0: // Floating
                        this.floatingBehavior();
                        break;
                    case 1: // Spiral
                        this.spiralBehavior();
                        break;
                    case 2: // Fireworks
                        this.fireworksBehavior();
                        break;
                    case 3: // Wave
                        this.waveBehavior();
                        break;
                }
                
                this.vel.add(this.acc);
                this.vel.limit(8);
                this.pos.add(this.vel);
                this.acc.mult(0);
                this.angle += this.angleVel;
                
                if (this.isExplosion) {
                    this.lifespan -= 2;
                    this.vel.mult(0.95);
                }
                
                // Wrap around edges
                if (this.pos.x < 0) this.pos.x = width;
                if (this.pos.x > width) this.pos.x = 0;
                if (this.pos.y < 0) this.pos.y = height;
                if (this.pos.y > height) this.pos.y = 0;
            }
            
            floatingBehavior() {
                // Attraction to mouse/touch
                // p5.js automatically updates mouseX/mouseY for touch events too
                let mouse = createVector(mouseX, mouseY);
                
                // Only attract if mouse is pressed or within canvas
                if (mouseIsPressed || (touches.length > 0)) {
                    let force = p5.Vector.sub(mouse, this.pos);
                    let distance = force.mag();
                    distance = constrain(distance, 5, 200);
                    force.normalize();
                    let strength = (200 / distance) * 0.5; // Increased strength for mobile feel
                    force.mult(strength);
                    this.applyForce(force);
                }
                
                // Random drift
                this.applyForce(p5.Vector.random2D().mult(0.1));
            }
            
            spiralBehavior() {
                let center = createVector(width / 2, height / 2);
                let toCenter = p5.Vector.sub(center, this.pos);
                
                // Spiral force
                let angle = atan2(toCenter.y, toCenter.x);
                let spiralForce = createVector(cos(angle + HALF_PI), sin(angle + HALF_PI));
                spiralForce.mult(2);
                this.applyForce(spiralForce);
                
                // Center attraction
                toCenter.normalize();
                toCenter.mult(0.5);
                this.applyForce(toCenter);
            }
            
            fireworksBehavior() {
                this.applyForce(createVector(0, 0.1)); // Gravity
                
                if (random(1) < 0.01) {
                    this.applyForce(p5.Vector.random2D().mult(3));
                }
            }
            
            waveBehavior() {
                let wave = sin(this.pos.x * 0.01 + frameCount * 0.05) * 2;
                this.applyForce(createVector(0, wave));
                this.applyForce(createVector(1, 0));
            }
            
            display() {
                let c = this.color;
                c.setAlpha(this.lifespan);
                
                push();
                translate(this.pos.x, this.pos.y);
                rotate(this.angle);
                
                // Glow effect (Expensive on mobile, simplified if framerate drops)
                if (frameRate() > 30) {
                    drawingContext.shadowBlur = 15;
                    drawingContext.shadowColor = c;
                } else {
                    drawingContext.shadowBlur = 0;
                }
                
                fill(c);
                noStroke();
                
                // Different shapes based on mode
                if (mode === 1) {
                    ellipse(0, 0, this.size * 2, this.size * 0.5);
                } else if (mode === 2) {
                    // Optimized star for performance
                    ellipse(0, 0, this.size * 1.5);
                } else {
                    ellipse(0, 0, this.size);
                }
                
                pop();
            }
            
            isDead() {
                return this.lifespan < 0;
            }
        }
        
        function setup() {
            createCanvas(windowWidth, windowHeight);
            resetParticles();
        }
        
        function draw() {
            // Trail effect
            if (showTrails) {
                fill(0, 20);
            } else {
                fill(0, 60); // Slightly darker clear for better contrast
            }
            rect(0, 0, width, height);
            
            // Update and display particles
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                particles[i].display();
                
                if (particles[i].isDead()) {
                    particles.splice(i, 1);
                }
            }
            
            // Maintain particle count (adjusted for mobile performance)
            let maxParticles = (width < 600) ? 120 : 200; 
            while (particles.length < maxParticles) {
                particles.push(new Particle());
            }
        }
        
        // Mouse & Touch Interactions
        function spawnExplosion(x, y) {
            for (let i = 0; i < 40; i++) {
                particles.push(new Particle(x, y, true));
            }
        }

        function mousePressed() {
            // Prevent interaction if clicking buttons (handled by HTML)
            if (mouseY > height - 100 && mouseX > width * 0.1 && mouseX < width * 0.9) return;
            spawnExplosion(mouseX, mouseY);
            return false; // Prevent default
        }

        function touchStarted() {
             // Prevent interaction if touching buttons
            if (mouseY > height - 100 && mouseX > width * 0.1 && mouseX < width * 0.9) return;
            spawnExplosion(mouseX, mouseY);
            return false; // Prevent scrolling
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }
    </script>
</body>
</html>
